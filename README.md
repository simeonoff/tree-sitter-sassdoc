# tree-sitter-sassdoc

A [tree-sitter](https://tree-sitter.github.io/tree-sitter/) grammar for [SassDoc](http://sassdoc.com/) documentation comments.

## Overview

This parser provides syntax highlighting and structural parsing for SassDoc documentation comments in SCSS files. It's designed to be used as an injected language within `tree-sitter-scss`.

## Supported Annotations

| Annotation    | Aliases                           | Description                                                           |
|---------------|-----------------------------------|-----------------------------------------------------------------------|
| `@param`      | `@parameter`, `@arg`, `@argument` | Documents a parameter with type, name, default value, and description |
| `@return`     | `@returns`                        | Documents the return value with type and description                  |
| `@type`       |                                   | Documents the type of a variable                                      |
| `@access`     |                                   | Access level (`public` or `private`)                                  |
| `@author`     |                                   | Author of the documented item                                         |
| `@deprecated` |                                   | Marks item as deprecated with optional message                        |
| `@example`    |                                   | Code example with optional language identifier                        |
| `@group`      |                                   | Group the documented item belongs to                                  |
| `@see`        |                                   | Reference to related items                                            |
| `@require`    | `@requires`                       | Dependencies required by the documented item                          |
| `@since`      |                                   | Version when the item was added                                       |
| `@throw`      | `@throws`, `@exception`           | Exceptions that may be thrown                                         |
| `@todo`       |                                   | Tasks to be completed                                                 |
| `@output`     |                                   | Output generated by a mixin                                           |
| `@content`    |                                   | Documents use of `@content` directive in mixins                       |
| `@ignore`     |                                   | Content to be ignored by documentation generators                     |

## Features

- Full support for `///` triple-slash comment style
- Union types: `{String | Number | Bool}`
- Variable references: `$variable-name`
- Default values: `[default-value]`
- Descriptions with `-` separator
- Group names and version numbers
- See/require references with type specifiers: `{mixin}`, `{function}`, `{variable}`, `{placeholder}`

## Installation

### Neovim (with nvim-treesitter)

Add the parser configuration to your Neovim config:

```lua
local parser_config = require("nvim-treesitter.parsers").get_parser_configs()

parser_config.sassdoc = {
  install_info = {
    url = "https://github.com/simeonoff/tree-sitter-sassdoc",
    files = { "src/parser.c" },
    branch = "main",
  },
  filetype = "sassdoc",
}

-- Add queries to runtime path
vim.opt.runtimepath:append("/path/to/tree-sitter-sassdoc")
```

Then install the parser:

```vim
:TSInstall sassdoc
```

### SCSS Injection

To enable SassDoc highlighting within SCSS files, add this injection query to your SCSS queries (`~/.config/nvim/queries/scss/injections.scm`):

```scheme
; extends

; Inject sassdoc into /// documentation comments
((single_line_comment) @injection.content
  (#match? @injection.content "^///")
  (#set! injection.language "sassdoc"))
```

## Example

```scss
/// Calculates the sum of two numbers.
///
/// @param {Number} $a - The first number
/// @param {Number} $b - The second number
/// @return {Number} The sum of $a and $b
/// @example scss
///   $result: sum(1, 2); // Returns 3
/// @see subtract
/// @since 1.0.0
/// @author John Doe
@function sum($a, $b) {
  @return $a + $b;
}
```

## Syntax Tree

The above example produces a tree like:

```
(document
  (description)
  (tag (tag_param (type (type_name)) (variable_name) (tag_description (line_description))))
  (tag (tag_param (type (type_name)) (variable_name) (tag_description (line_description))))
  (tag (tag_return (type (type_name)) (line_description)))
  (tag (tag_example (example_language) (code_block)))
  (tag (tag_see (see_reference)))
  (tag (tag_since (version)))
  (tag (tag_author (line_description))))
```

## Development

### Building

```bash
npm install
tree-sitter generate
```

### Testing

```bash
tree-sitter test
```

### Testing a file

```bash
tree-sitter parse example.sassdoc
```

## Highlight Capture Groups

The following highlight capture groups are used:

| Capture             | Description                            |
|---------------------|----------------------------------------|
| `@keyword`          | Tag names (`@param`, `@return`, etc.)  |
| `@keyword.modifier` | Access modifiers (`public`, `private`) |
| `@type`             | Type names and references              |
| `@variable`         | Variable names (`$name`)               |
| `@number`           | Version numbers                        |
| `@comment`          | Description text                       |
| `@label`            | Example language identifier            |
| `@string`           | Code blocks and default values         |
| `@function`         | See/require references                 |
| `@module`           | Group names                            |

## License

MIT
